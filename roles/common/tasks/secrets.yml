---
# =============================================================================
# Secret auto-generation - Equivalent deploy.sh lines 1422-1490
# =============================================================================
# For each secret: check if defined in vault.yml, if empty generate and
# write to .env via lineinfile. Types:
#   base64    = python3 urlsafe_b64encode(32 bytes)
#   base64-48 = openssl rand -base64 48
#   hex-16    = openssl rand -hex 16

- name: Process auto-generated secrets
  ansible.builtin.include_tasks: _generate_one_secret.yml
  loop: "{{ auto_secrets }}"
  loop_control:
    loop_var: secret
  when: secret.condition | bool
