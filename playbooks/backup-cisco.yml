---
# =============================================================================
# BACKUP-CISCO.YML - Sauvegarde configs Cisco IOS/IOS-XE
# =============================================================================
#
# ┌─────────────────────────────────────────────────────────────────────────┐
# │                      BACKUP CONFIGURATIONS CISCO                       │
# ├─────────────────────────────────────────────────────────────────────────┤
# │                                                                         │
# │  ACTIONS EFFECTUEES :                                                   │
# │  ────────────────────                                                   │
# │    1. Connexion SSH aux equipements Cisco                               │
# │    2. Recuperation running-config                                       │
# │    3. Sauvegarde locale avec horodatage                                 │
# │    4. Commit et push Git (optionnel)                                    │
# │                                                                         │
# │  PREREQUIS :                                                            │
# │  ───────────                                                            │
# │    ansible-galaxy collection install -r requirements.yml                │
# │    (cisco.ios, ansible.netcommon)                                       │
# │                                                                         │
# │  CREDENTIALS :                                                          │
# │  ─────────────                                                          │
# │    Methode 1 - Semaphore Key Store :                                    │
# │      Creer une clef "cisco" de type Login (user/password)               │
# │                                                                         │
# │    Methode 2 - Variables extra :                                        │
# │      -e ansible_user=admin -e ansible_password=secret                   │
# │                                                                         │
# │  VARIABLES :                                                            │
# │  ───────────                                                            │
# │    cisco_backup_git_push : Push vers Git (defaut: true)                 │
# │                                                                         │
# └─────────────────────────────────────────────────────────────────────────┘
#
# Usage:
#   ansible-playbook playbooks/backup-cisco.yml
#   ansible-playbook playbooks/backup-cisco.yml --limit sw-core-01
#   ansible-playbook playbooks/backup-cisco.yml -e cisco_backup_git_push=false
#
# =============================================================================

- name: Backup Cisco IOS/IOS-XE running-config
  hosts: network
  gather_facts: false

  roles:
    - role: cisco_backup
      tags:
        - cisco-backup
