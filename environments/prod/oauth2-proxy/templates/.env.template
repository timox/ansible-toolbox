# Configuration oauth2-proxy - Template
# Copier ce fichier vers .env et configurer les valeurs

# Domaine principal
DOMAIN=example.com

# Keycloak OIDC
KEYCLOAK_ISSUER=https://keycloak.example.com/realms/portal
KEYCLOAK_HOST=keycloak.example.com
KEYCLOAK_REALM=portal
OIDC_CLIENT_ID=oauth2-proxy
OIDC_CLIENT_SECRET=YOUR_CLIENT_SECRET_FROM_KEYCLOAK

# Cookie secret (générer avec: python3 -c 'import os,base64; print(base64.urlsafe_b64encode(os.urandom(32)).decode())')
COOKIE_SECRET=YOUR_COOKIE_SECRET_HERE

# Certificats SSL (chemins sur l'hôte)
TLS_CERT_FILE=/data/certs/wildcard.example.com.crt
TLS_KEY_FILE=/data/certs/wildcard.example.com.key

# Mode HTTP/HTTPS oauth2-proxy
# Production HTTPS:
#   OAUTH2_PROXY_REDIRECT_URL=https://portail.example.com/oauth2/callback
#   OAUTH2_PROXY_HTTPS_ADDRESS=:44180
#   OAUTH2_PROXY_COOKIE_DOMAINS=.example.com
#   OAUTH2_PROXY_COOKIE_SECURE=true
# POC/Dev HTTP:
#   OAUTH2_PROXY_REDIRECT_URL=http://192.168.x.x:4180/oauth2/callback
#   OAUTH2_PROXY_HTTPS_ADDRESS=
#   OAUTH2_PROXY_COOKIE_DOMAINS=192.168.x.x
#   OAUTH2_PROXY_COOKIE_SECURE=false
OAUTH2_PROXY_REDIRECT_URL=https://portail.example.com/oauth2/callback
OAUTH2_PROXY_HTTPS_ADDRESS=:44180
OAUTH2_PROXY_COOKIE_DOMAINS=.example.com
OAUTH2_PROXY_COOKIE_SECURE=true

# Applications backend (exemples)
# Ces variables peuvent être utilisées dans nginx/apps.conf.template
GUACAMOLE_BACKEND=http://guacamole:8080
GLPI_BACKEND=http://glpi:80
ZABBIX_BACKEND=http://zabbix:8080
NEXTCLOUD_BACKEND=http://nextcloud:80
WIKI_BACKEND=http://wiki:80
VCENTER_BACKEND=https://vcenter.internal.example.com:443

# ManageEngine RADIUS (pour référence Keycloak)
RADIUS_SERVER=10.0.0.50
RADIUS_PORT=1812
RADIUS_SECRET=your_radius_secret_here

# Groupes Keycloak pour controle d'acces
# Groupe admin du portail (panneau administration)
PORTAL_ADMIN_GROUP=admins-portail

# === GUACAMOLE OIDC (authentification directe avec Keycloak) ===
# Client OIDC Guacamole (creer dans Keycloak, separe de oauth2-proxy)
# IMPORTANT: Access Type = public (pas confidential) car Guacamole utilise implicit flow
# Valid Redirect URIs: https://guacamole.example.com/*
GUACAMOLE_OIDC_CLIENT_ID=guacamole

# Groupe Keycloak pour les ADMINS Guacamole
GUACAMOLE_ADMIN_GROUP=GG-POM-ADMINS-GUAC

# Options avancées
OAUTH2_PROXY_LOG_LEVEL=info
OAUTH2_PROXY_SKIP_PROVIDER_BUTTON=false
